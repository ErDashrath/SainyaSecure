# Generated by Django 5.2.6 on 2025-09-13 13:28

import uuid
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='AnomalyAlert',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('alert_id', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('alert_type', models.CharField(choices=[('CONTENT_ANOMALY', 'Suspicious Message Content'), ('BEHAVIORAL_ANOMALY', 'Unusual User Behavior'), ('TIMING_ANOMALY', 'Unusual Communication Timing'), ('VOLUME_ANOMALY', 'Abnormal Message Volume'), ('NETWORK_ANOMALY', 'Network Pattern Anomaly'), ('SPOOFING_ATTEMPT', 'Potential Identity Spoofing'), ('MALICIOUS_CONTENT', 'Potentially Malicious Content'), ('INFORMATION_LEAK', 'Potential Information Leak'), ('UNAUTHORIZED_ACCESS', 'Unauthorized Access Attempt'), ('SYSTEM_COMPROMISE', 'Potential System Compromise')], max_length=20)),
                ('severity', models.CharField(choices=[('INFO', 'Informational'), ('LOW', 'Low Risk'), ('MEDIUM', 'Medium Risk'), ('HIGH', 'High Risk'), ('CRITICAL', 'Critical Threat')], default='MEDIUM', max_length=8)),
                ('confidence_score', models.DecimalField(decimal_places=4, help_text='Model confidence (0.0-1.0)', max_digits=5)),
                ('anomaly_score', models.DecimalField(decimal_places=4, help_text='Anomaly score from model', max_digits=8)),
                ('detection_threshold', models.DecimalField(decimal_places=4, help_text='Threshold used for detection', max_digits=5)),
                ('title', models.CharField(help_text='Brief alert description', max_length=200)),
                ('description', models.TextField(help_text='Detailed alert description')),
                ('evidence', models.JSONField(default=dict, help_text='Supporting evidence and analysis')),
                ('affected_entities', models.JSONField(default=list, help_text='List of affected users, devices, messages')),
                ('detection_context', models.JSONField(default=dict, help_text='Context at time of detection')),
                ('related_patterns', models.JSONField(default=list, help_text='Related anomalous patterns')),
                ('risk_factors', models.JSONField(default=list, help_text='Identified risk factors')),
                ('status', models.CharField(choices=[('NEW', 'New Alert'), ('ACKNOWLEDGED', 'Acknowledged'), ('INVESTIGATING', 'Under Investigation'), ('RESOLVED', 'Resolved'), ('FALSE_POSITIVE', 'False Positive'), ('ESCALATED', 'Escalated'), ('SUPPRESSED', 'Suppressed')], default='NEW', max_length=15)),
                ('response_actions', models.JSONField(default=list, help_text='Actions taken in response')),
                ('resolution_notes', models.TextField(blank=True)),
                ('escalation_level', models.IntegerField(default=0, help_text='Current escalation level')),
                ('auto_escalation_enabled', models.BooleanField(default=True)),
                ('escalation_deadline', models.DateTimeField(blank=True, null=True)),
                ('detected_at', models.DateTimeField(auto_now_add=True)),
                ('acknowledged_at', models.DateTimeField(blank=True, null=True)),
                ('resolved_at', models.DateTimeField(blank=True, null=True)),
                ('last_updated_at', models.DateTimeField(auto_now=True)),
                ('potential_impact', models.CharField(choices=[('INFO', 'Informational'), ('LOW', 'Low Risk'), ('MEDIUM', 'Medium Risk'), ('HIGH', 'High Risk'), ('CRITICAL', 'Critical Threat')], default='MEDIUM', max_length=8)),
                ('business_impact_score', models.DecimalField(decimal_places=2, default=0.0, max_digits=3)),
                ('affects_mission_critical', models.BooleanField(default=False)),
                ('is_true_positive', models.BooleanField(blank=True, help_text='Human feedback for model training', null=True)),
                ('feedback_notes', models.TextField(blank=True)),
            ],
            options={
                'verbose_name': 'Anomaly Alert',
                'verbose_name_plural': 'Anomaly Alerts',
                'db_table': 'anomaly_alerts',
                'ordering': ['-severity', '-detected_at'],
            },
        ),
        migrations.CreateModel(
            name='AnomalyDetectionModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('model_id', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('name', models.CharField(help_text='Human-readable model name', max_length=100)),
                ('version', models.CharField(help_text='Model version (e.g., v1.2.3)', max_length=20)),
                ('model_type', models.CharField(choices=[('DISTILBERT', 'DistilBERT NLP Model'), ('LSTM', 'LSTM Neural Network'), ('TRANSFORMER', 'Transformer Model'), ('RANDOM_FOREST', 'Random Forest'), ('SVM', 'Support Vector Machine'), ('ENSEMBLE', 'Ensemble Model'), ('RULE_BASED', 'Rule-Based System')], max_length=15)),
                ('description', models.TextField(help_text='Model description and purpose')),
                ('training_objective', models.TextField(help_text='What this model is trained to detect')),
                ('supported_languages', models.JSONField(default=list, help_text='Supported languages for NLP models')),
                ('training_dataset_size', models.IntegerField(default=0, help_text='Number of training samples')),
                ('training_started_at', models.DateTimeField(blank=True, null=True)),
                ('training_completed_at', models.DateTimeField(blank=True, null=True)),
                ('training_duration_hours', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('hyperparameters', models.JSONField(default=dict, help_text='Model hyperparameters')),
                ('feature_config', models.JSONField(default=dict, help_text='Feature extraction configuration')),
                ('preprocessing_steps', models.JSONField(default=list, help_text='Data preprocessing pipeline')),
                ('model_file_path', models.TextField(help_text='Path to serialized model file')),
                ('model_size_bytes', models.BigIntegerField(default=0)),
                ('checksum', models.CharField(help_text='Model file checksum', max_length=64)),
                ('accuracy', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('precision', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('recall', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('f1_score', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('false_positive_rate', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('false_negative_rate', models.DecimalField(blank=True, decimal_places=4, max_digits=5, null=True)),
                ('status', models.CharField(choices=[('TRAINING', 'Training in Progress'), ('TRAINED', 'Training Complete'), ('TESTING', 'Under Testing'), ('DEPLOYED', 'Deployed in Production'), ('DEPRECATED', 'Deprecated'), ('FAILED', 'Training/Deployment Failed')], default='TRAINING', max_length=10)),
                ('is_active', models.BooleanField(default=False, help_text='Currently active in production')),
                ('deployment_priority', models.IntegerField(default=0, help_text='Deployment priority (higher = more priority)')),
                ('total_predictions', models.BigIntegerField(default=0)),
                ('total_anomalies_detected', models.BigIntegerField(default=0)),
                ('average_inference_time_ms', models.DecimalField(decimal_places=2, default=0.0, max_digits=8)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('deployed_at', models.DateTimeField(blank=True, null=True)),
                ('last_used_at', models.DateTimeField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Anomaly Detection Model',
                'verbose_name_plural': 'Anomaly Detection Models',
                'db_table': 'anomaly_detection_models',
                'ordering': ['-version', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='BehavioralProfile',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('profile_id', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('profile_start_date', models.DateTimeField()),
                ('profile_end_date', models.DateTimeField()),
                ('is_active', models.BooleanField(default=True)),
                ('avg_messages_per_day', models.DecimalField(decimal_places=2, default=0.0, max_digits=8)),
                ('avg_message_length', models.DecimalField(decimal_places=2, default=0.0, max_digits=8)),
                ('peak_activity_hours', models.JSONField(default=list, help_text='Hours of peak activity')),
                ('typical_contacts', models.JSONField(default=list, help_text='Frequently contacted users')),
                ('common_keywords', models.JSONField(default=dict, help_text='Common keyword frequencies (anonymized)')),
                ('message_types_distribution', models.JSONField(default=dict, help_text='Distribution of message types')),
                ('conversation_types_distribution', models.JSONField(default=dict, help_text='Distribution of conversation types')),
                ('primary_devices', models.JSONField(default=list, help_text='Most frequently used devices')),
                ('typical_locations', models.JSONField(default=list, help_text='Common location patterns')),
                ('mobility_patterns', models.JSONField(default=dict, help_text='Movement and mobility analysis')),
                ('avg_response_time_seconds', models.DecimalField(decimal_places=2, default=0.0, max_digits=10)),
                ('response_time_distribution', models.JSONField(default=dict, help_text='Response time percentiles')),
                ('online_hours_distribution', models.JSONField(default=dict, help_text='Online activity distribution')),
                ('authentication_methods', models.JSONField(default=dict, help_text='Preferred authentication methods')),
                ('security_events_frequency', models.DecimalField(decimal_places=2, default=0.0, max_digits=8)),
                ('suspicious_activity_baseline', models.DecimalField(decimal_places=4, default=0.0, max_digits=5)),
                ('total_messages_analyzed', models.BigIntegerField(default=0)),
                ('profile_confidence_score', models.DecimalField(decimal_places=2, default=0.0, max_digits=3)),
                ('last_updated_at', models.DateTimeField(auto_now=True)),
                ('profile_drift_score', models.DecimalField(decimal_places=4, default=0.0, max_digits=5)),
                ('significant_drift_detected', models.BooleanField(default=False)),
                ('last_drift_check', models.DateTimeField(blank=True, null=True)),
            ],
            options={
                'verbose_name': 'Behavioral Profile',
                'verbose_name_plural': 'Behavioral Profiles',
                'db_table': 'behavioral_profiles',
            },
        ),
        migrations.CreateModel(
            name='ModelPerformanceMetrics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('metrics_id', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('measurement_date', models.DateTimeField(auto_now_add=True)),
                ('period_start', models.DateTimeField()),
                ('period_end', models.DateTimeField()),
                ('total_predictions', models.BigIntegerField(default=0)),
                ('true_positives', models.BigIntegerField(default=0)),
                ('false_positives', models.BigIntegerField(default=0)),
                ('true_negatives', models.BigIntegerField(default=0)),
                ('false_negatives', models.BigIntegerField(default=0)),
                ('accuracy', models.DecimalField(decimal_places=4, default=0.0, max_digits=5)),
                ('precision', models.DecimalField(decimal_places=4, default=0.0, max_digits=5)),
                ('recall', models.DecimalField(decimal_places=4, default=0.0, max_digits=5)),
                ('f1_score', models.DecimalField(decimal_places=4, default=0.0, max_digits=5)),
                ('specificity', models.DecimalField(decimal_places=4, default=0.0, max_digits=5)),
                ('accuracy_trend', models.CharField(choices=[('IMPROVING', 'Improving'), ('STABLE', 'Stable'), ('DECLINING', 'Declining')], default='STABLE', max_length=10)),
                ('average_inference_time_ms', models.DecimalField(decimal_places=2, default=0.0, max_digits=8)),
                ('max_inference_time_ms', models.DecimalField(decimal_places=2, default=0.0, max_digits=8)),
                ('throughput_per_second', models.DecimalField(decimal_places=2, default=0.0, max_digits=8)),
                ('cpu_usage_percent', models.DecimalField(decimal_places=2, default=0.0, max_digits=5)),
                ('memory_usage_mb', models.DecimalField(decimal_places=2, default=0.0, max_digits=10)),
                ('gpu_usage_percent', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('data_drift_score', models.DecimalField(decimal_places=4, default=0.0, max_digits=5)),
                ('concept_drift_score', models.DecimalField(decimal_places=4, default=0.0, max_digits=5)),
                ('drift_detected', models.BooleanField(default=False)),
                ('user_satisfaction_score', models.DecimalField(blank=True, decimal_places=2, max_digits=3, null=True)),
                ('alert_quality_score', models.DecimalField(decimal_places=2, default=0.0, max_digits=3)),
                ('needs_retraining', models.BooleanField(default=False)),
                ('retraining_priority', models.CharField(choices=[('LOW', 'Low'), ('MEDIUM', 'Medium'), ('HIGH', 'High'), ('URGENT', 'Urgent')], default='LOW', max_length=8)),
            ],
            options={
                'verbose_name': 'Model Performance Metrics',
                'verbose_name_plural': 'Model Performance Metrics',
                'db_table': 'model_performance_metrics',
                'ordering': ['-measurement_date'],
            },
        ),
        migrations.CreateModel(
            name='ThreatIntelligence',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('intel_id', models.UUIDField(default=uuid.uuid4, editable=False, unique=True)),
                ('intel_type', models.CharField(choices=[('IOC', 'Indicator of Compromise'), ('ATTACK_PATTERN', 'Attack Pattern'), ('THREAT_ACTOR', 'Threat Actor'), ('MALWARE', 'Malware Signature'), ('VULNERABILITY', 'Security Vulnerability'), ('TECHNIQUE', 'Attack Technique')], max_length=15)),
                ('name', models.CharField(help_text='Threat intelligence name/title', max_length=200)),
                ('description', models.TextField()),
                ('indicators', models.JSONField(default=list, help_text='List of indicators (hashes, IPs, domains, etc.)')),
                ('tactics_techniques', models.JSONField(default=list, help_text='MITRE ATT&CK tactics and techniques')),
                ('source_name', models.CharField(help_text='Intelligence source', max_length=100)),
                ('source_reliability', models.CharField(choices=[('LOW', 'Low Confidence'), ('MEDIUM', 'Medium Confidence'), ('HIGH', 'High Confidence'), ('CONFIRMED', 'Confirmed')], default='MEDIUM', max_length=10)),
                ('external_references', models.JSONField(default=list, help_text='External reference links')),
                ('confidence_level', models.CharField(choices=[('LOW', 'Low Confidence'), ('MEDIUM', 'Medium Confidence'), ('HIGH', 'High Confidence'), ('CONFIRMED', 'Confirmed')], default='MEDIUM', max_length=10)),
                ('threat_level', models.CharField(choices=[('INFO', 'Informational'), ('LOW', 'Low Risk'), ('MEDIUM', 'Medium Risk'), ('HIGH', 'High Risk'), ('CRITICAL', 'Critical Threat')], default='MEDIUM', max_length=8)),
                ('applicability_score', models.DecimalField(decimal_places=2, default=0.5, max_digits=3)),
                ('detection_rules', models.JSONField(default=list, help_text='Automated detection rules')),
                ('yara_rules', models.TextField(blank=True, help_text='YARA detection rules')),
                ('regex_patterns', models.JSONField(default=list, help_text='Regular expression patterns')),
                ('times_matched', models.IntegerField(default=0)),
                ('last_matched_at', models.DateTimeField(blank=True, null=True)),
                ('false_positive_count', models.IntegerField(default=0)),
                ('is_active', models.BooleanField(default=True)),
                ('expires_at', models.DateTimeField(blank=True, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Threat Intelligence',
                'verbose_name_plural': 'Threat Intelligence',
                'db_table': 'threat_intelligence',
                'ordering': ['-threat_level', '-updated_at'],
            },
        ),
    ]
